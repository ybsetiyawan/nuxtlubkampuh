<template>
    <div>
      <v-dialog v-model="dialogMenuUser" scrollable max-width="700px">
        <v-card>
          <v-card-title
            style="color: #5cb270; padding-top: 12px; padding-bottom: 12px"
          >
            <span style="font-size: 20px; padding-right: 10px">{{
              formTitle
            }}</span>
            <v-spacer></v-spacer>
            <v-btn icon @click="closeFormMenuUser()" style="color: white">
              <v-icon>mdi-close</v-icon>
            </v-btn>
          </v-card-title>
          <v-divider></v-divider>
          <v-card-text>
            <v-form
              onSubmit="return false"
              ref="formAkses"
              v-model="valid"
              lazy-validation
            >
              <div style="padding: 30px 15px 15px 15px">
                <v-alert
                  text
                  outlined
                  color="#5cb270"
                  icon="mdi-information-outline"
                >
                  Anda akan menambahkan menu untuk
                  <strong>Role : {{ roleSelected.name }}</strong>
                </v-alert>
                <br />
                <v-layout row>
                  <v-flex xs12 sm12 md3>
                    <v-subheader>Level Menu :</v-subheader>
                  </v-flex>
                  <v-flex xs12 sm8 md8>
                    <v-select
                      color="#5cb270"
                      v-model="level"
                      :items="list_level"
                      label="Pilih Level . . ."
                      @change="parent_selected = ''"
                      outlined
                    />
                  </v-flex>
                </v-layout>
                <v-layout row v-show="level != '' && level != null">
                  <v-flex xs12 sm12 md3>
                    <v-subheader>Posisi :</v-subheader>
                  </v-flex>
                  <v-flex xs12 sm8 md8>
                    <v-select
                      color="#5cb270"
                      v-model="posisi"
                      :items="list_posisi"
                      label="Pilih Posisi . . ."
                      outlined
                    />
                  </v-flex>
                </v-layout>
                <v-layout row v-show="level != '' && level != null && level != 1">
                  <v-flex xs12 sm12 md3>
                    <v-subheader>Parent :</v-subheader>
                  </v-flex>
                  <v-flex xs12 sm8 md8>
                    <v-autocomplete
                      color="#5cb270"
                      v-model="parent_selected"
                      :items="list_menu"
                      outlined
                      chips
                      label="Pilih Parent Menu"
                      item-text="namaMenu"
                      item-value="id"
                    >
                      <template v-slot:selection="data">
                        <v-chip
                          color="#5cb270"
                          v-bind="data.attrs"
                          :input-value="data.selected"
                          close
                          @click="data.select"
                          @click:close="remove(data.item)"
                        >
                          <v-avatar left>
                            <v-icon>{{ data.item.classIcon }}</v-icon>
                          </v-avatar>
                          {{ data.item.namaMenu }}
                        </v-chip>
                      </template>
  
                      <template slot="item" slot-scope="data">
                        <template v-if="data.item !== 'object'">
                          <v-list-item-avatar>
                            <v-icon>
                              {{ data.item.classIcon }}
                            </v-icon>
                          </v-list-item-avatar>
                          <v-list-item-content>
                            <v-list-item-title
                              v-text="data.item.namaMenu"
                            ></v-list-item-title>
                            <v-list-item-subtitle>
                              Link:
                              {{ data.item.linkMenu ? data.item.linkMenu : "" }} -
                              Ket:
                              {{
                                data.item.keterangan ? data.item.keterangan : ""
                              }}
                            </v-list-item-subtitle>
                          </v-list-item-content>
                        </template>
                        <template v-else>
                          <v-list-item-content
                            v-text="data.item"
                          ></v-list-item-content>
                        </template>
                      </template>
                    </v-autocomplete>
                  </v-flex>
                </v-layout>
  
                
                <v-layout row v-show="level != '' && level != null">
                  <v-flex xs12 sm12 md3>
                    <v-subheader>Menu :</v-subheader>
                  </v-flex>
                  <v-flex xs12 sm8 md8>
                    <v-autocomplete
                      color="#5cb270"
                      v-model="menu_selected"
                      :items="list_menu"
                      outlined
                      chips
                      label="Pilih Menu"
                      item-text="namaMenu"
                      item-value="id"
                      multiple
                    >
                      <template v-slot:selection="data">
                        <v-chip
                          v-bind="data.attrs"
                          :input-value="data.selected"
                          close
                          @click="data.select"
                          @click:close="remove(data.item)"
                        >
                          <v-avatar left>
                            <v-icon>{{ data.item.classIcon }}</v-icon>
                          </v-avatar>
                          {{ data.item.namaMenu }}
                        </v-chip>
                      </template>
  
                      <template slot="item" slot-scope="data">
                        <template v-if="data.item !== 'object'">
                          <v-list-item-avatar>
                            <v-icon>
                              {{ data.item.classIcon }}
                            </v-icon>
                          </v-list-item-avatar>
                          <v-list-item-content>
                            <v-list-item-title
                              v-text="data.item.namaMenu"
                            ></v-list-item-title>
                            <v-list-item-subtitle>
                              Link:
                              {{ data.item.linkMenu ? data.item.linkMenu : "" }} -
                              Ket:
                              {{
                                data.item.keterangan ? data.item.keterangan : ""
                              }}
                            </v-list-item-subtitle>
                          </v-list-item-content>
                        </template>
                        <template v-else>
                          <v-list-item-content
                            v-text="data.item"
                          ></v-list-item-content>
                        </template>
                      </template>
                    </v-autocomplete>
                  </v-flex>
                </v-layout>
              </div>
            </v-form>
          </v-card-text>
          <v-divider></v-divider>
          <v-card-actions>
            <div class="ml-auto">
              <v-btn
                color="orange"
                @click="saveMenuUserValidate()"
                :disabled="roleSelected.id == ''"
              >
                Simpan
              </v-btn>
              <v-btn color="error" @click="closeFormMenuUser()"> Batal </v-btn>
            </div>
          </v-card-actions>
        </v-card>
      </v-dialog>
    </div>
  </template>
  
  <script src="./menu.components.ts"></script>
  